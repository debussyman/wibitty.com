{"version":3,"sources":["webpack:///webpack/bootstrap b62e931eeb2f60a514dc","webpack:///./js/main.js"],"names":["TrainSpeed","Train","name","route","map","icon","firstStop","shift","id","departAt","toString","console","log","position","nextStation","atStation","marker","L","lat","lng","addTo","intervalId","setInterval","updateMarker","move","destroy","latlng","latLng","setLatLng","remove","clearInterval","now","LocalDateTime","isAfter","deltas","howFar","moves","until","minusSeconds","ChronoUnit","MILLIS","deltaLat","deltaLong","SixTrainNorth","SixTrainSouth","FFTrainSouth","FFTrainNorth","JSJoda","sixtrain","iconUrl","iconSize","Math","random","stops","i","length","push","plusSeconds","setTimeout","fftrain","document","addEventListener","mymap","zoomControl","dragging","boxZoom","doubleClickZoom","scrollWheelZoom","setView","tileLayer","attribution","apikey","maxZoom"],"mappings":"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","file":"main.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b62e931eeb2f60a514dc","let TrainSpeed = 100;\n\nclass Train {\n  constructor(name, route, map, icon) {\n    let firstStop = route.shift();\n    this.id = `${name}.${firstStop.departAt.toString()}`;\n    console.log(\"Creating new train\", this.id);\n    this.position = firstStop;\n    this.nextStation = firstStop;\n    this.route = route;\n    this.atStation = true;\n    this.marker = L.marker([this.position.lat, this.position.lng], {icon: icon})\n      .addTo(map);\n    this.intervalId = setInterval(() => this.updateMarker(), TrainSpeed);\n  }\n\n  updateMarker() {\n    this.move();\n    if (this.nextStation == null) {\n      this.destroy();\n    } else {\n      let latlng = L.latLng(this.position.lat, this.position.lng);\n      this.marker.setLatLng(latlng);\n    }\n  }\n\n  destroy() {\n    this.marker.remove();\n    clearInterval(this.intervalId);\n  }\n\n  move() {\n    let now = LocalDateTime.now();\n    if (this.nextStation == null) {\n      // do nothing\n    } else if (this.atStation && this.nextStation.departAt.isAfter(LocalDateTime.now())) {\n    } else if (this.atStation) {\n      this.nextStation = this.route.shift();\n      this.atStation = false;\n      this.move();\n    } else {\n      let deltas = this.howFar();\n      // if we are close enough, just move to the station\n      if (deltas[0] == 0 && deltas[1] == 0) {\n        this.atStation = true;\n      } else {\n        this.position = {\n          lat: this.position.lat + deltas[0],\n          lng: this.position.lng + deltas[1]\n        }\n      }\n    }\n  }\n\n  howFar() {\n    let moves = LocalDateTime.now().until(this.nextStation.departAt.minusSeconds(5), ChronoUnit.MILLIS) / TrainSpeed;\n    if (moves < 1) {\n      moves = 1;\n    }\n\n    let deltaLat = (this.nextStation.lat - this.position.lat) / moves;\n    let deltaLong = (this.nextStation.lng - this.position.lng) / moves;\n    return [deltaLat, deltaLong];\n  }\n}\n\nlet SixTrainNorth = [\n  {lat: 40.746664, lng: -73.981891},\n  {lat: 40.752402, lng: -73.977470},\n  {lat: 40.757156, lng: -73.972160},\n  {lat: 40.762845, lng: -73.967535},\n  {lat: 40.762996, lng: -73.967868},\n  {lat: 40.768144, lng: -73.963872},\n  {lat: 40.773522, lng: -73.959746},\n  {lat: 40.779462, lng: -73.955830},\n  {lat: 40.785683, lng: -73.950927},\n  {lat: 40.790192, lng: -73.947682}\n]\n\nlet SixTrainSouth = [\n  {lat: 40.790192, lng: -73.947682},\n  {lat: 40.785683, lng: -73.950927},\n  {lat: 40.779462, lng: -73.955830},\n  {lat: 40.773522, lng: -73.959746},\n  {lat: 40.768144, lng: -73.963872},\n  {lat: 40.762996, lng: -73.967868},\n  {lat: 40.762845, lng: -73.967535},\n  {lat: 40.757156, lng: -73.972160},\n  {lat: 40.752402, lng: -73.977470},\n  {lat: 40.746664, lng: -73.981891}\n]\n\nlet FFTrainSouth = [\n  {lat: 40.804406, lng: -73.937221},\n  {lat: 40.779469, lng: -73.955841},\n  {lat: 40.762996, lng: -73.967868},\n  {lat: 40.752402, lng: -73.977470},\n  {lat: 40.735291, lng: -73.991064}\n]\n\nlet FFTrainNorth = [\n  {lat: 40.735291, lng: -73.991064},\n  {lat: 40.752402, lng: -73.977470},\n  {lat: 40.762996, lng: -73.967868},\n  {lat: 40.779469, lng: -73.955841},\n  {lat: 40.804406, lng: -73.937221}\n]\n\nlet LocalDateTime = JSJoda.LocalDateTime;\nlet ChronoUnit = JSJoda.ChronoUnit;\n\nlet sixtrain = (map) => {\n  let icon = L.icon({\n    iconUrl: 'img/6.png',\n    iconSize: [35, 35],\n  });\n  let route = SixTrainNorth;\n  if (Math.random() > 0.5) {\n    route = SixTrainSouth;\n  }\n  let stops = [];\n  for(let i=0; i<route.length; i++) {\n    stops.push({\n      lat: route[i].lat,\n      lng: route[i].lng,\n      departAt: LocalDateTime.now().plusSeconds(i*35)\n    })\n  }\n  new Train(\"6S\", stops, map, icon);\n  setTimeout(() => fftrain(map), 120000);\n}\n\nlet fftrain = (map) => {\n  let icon = L.icon({\n    iconUrl: 'img/4.png',\n    iconSize: [35, 35],\n  });\n  if (Math.random() > 0.5) {\n    icon = L.icon({\n      iconUrl: 'img/5.png',\n      iconSize: [35, 35],\n    });\n  }\n  let route = FFTrainSouth;\n  if (Math.random() > 0.5) {\n    route = FFTrainNorth;\n  }\n  let stops = [];\n  for(let i=0; i<route.length; i++) {\n    stops.push({\n      lat: route[i].lat,\n      lng: route[i].lng,\n      departAt: LocalDateTime.now().plusSeconds(i*35)\n    })\n  }\n  new Train(\"5S\", stops, map, icon);\n  setTimeout(() => fftrain(map), 60000);\n}\n\ndocument.addEventListener('DOMContentLoaded', () => { \n    let mymap = L.map('mapid', {\n      zoomControl: false,\n      dragging: false,\n      boxZoom: false,\n      doubleClickZoom: false,\n      scrollWheelZoom: false\n    }).setView([40.768, -73.985], 14);\n\n    L.tileLayer('https://{s}.tile.thunderforest.com/pioneer/{z}/{x}/{y}.png?apikey={apikey}', {\n        attribution: '&copy; <a href=\"http://www.thunderforest.com/\">Thunderforest</a>, &copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>',\n        apikey: 'da8d4e6212904e8fbf27c73c7b2a237e',\n        maxZoom: 22\n    }).addTo(mymap);\n\n    sixtrain(mymap);\n    fftrain(mymap);\n}, false);\n\n\n\n// WEBPACK FOOTER //\n// ./js/main.js"],"sourceRoot":""}